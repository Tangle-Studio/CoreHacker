<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Core Hacker - 3D Puzzle Prototype</title>
    <link rel="stylesheet" href="core-hacker.css">
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="loader">SYSTEM INITIALIZING...</div>

    <div id="victory-modal">
        <div class="victory-content">
            <div class="victory-title">SYSTEM HACKED!</div>
            <div class="victory-desc">코어 데이터를 성공적으로 추출했습니다.</div>
            <button class="restart-btn" id="modal-next-btn">NEXT LEVEL</button>
        </div>
    </div>

    <div id="intro-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">SYSTEM ACCESS GRANTED</div>
                <div class="modal-subtitle">MISSION: EXTRACT CORE DATA</div>
            </div>
            <div class="instructions">
                <div class="inst-item">
                    <span class="inst-icon">🎯</span>
                    <div class="inst-text">
                        <strong>목표:</strong> 빨간색 <b>CORE</b> 블록을 초록색 <b>EXIT</b> 구역으로 이동시키세요.
                    </div>
                </div>
                <div class="inst-item">
                    <span class="inst-icon">🖱️</span>
                    <div class="inst-text">
                        <strong>조작:</strong> 블록을 터치/클릭하여 선택한 후 하단 버튼이나 스와이프로 이동합니다.
                    </div>
                </div>
                <div class="inst-item">
                    <span class="inst-icon">🔄</span>
                    <div class="inst-text">
                        <strong>시점:</strong> 배경을 드래그하여 큐브를 회전시켜 내부를 확인하세요.
                    </div>
                </div>
                <div class="inst-item">
                    <span class="inst-icon">⚡</span>
                    <div class="inst-text">
                        <strong>X-RAY:</strong> 버튼을 누르면 내부 블록들을 투시할 수 있습니다.
                    </div>
                </div>
            </div>
            <button class="start-btn" id="start-game-btn">BREACH START</button>
        </div>
    </div>

    <div id="canvas-container"></div>

    <div id="ui-layer">
        <div class="top-bar">
            <div class="title-group">
                <h1>CORE HACKER</h1>
                <span class="subtitle">SYSTEM BREACH</span>
            </div>

            <div class="stats">
                <div class="stat">
                    <span class="stat-label">LEVEL</span>
                    <span class="stat-value" id="level-text">1/3</span>
                </div>
                <div class="stat">
                    <span class="stat-label">MOVES</span>
                    <span class="stat-value" id="move-text">0</span>
                </div>
            </div>

            <div class="actions">
                <button class="btn" id="undo-btn">UNDO</button>
                <button class="btn" id="reset-btn">RESET</button>
                <button class="btn" id="xray-btn">X-RAY</button>
                <button class="btn" id="help-btn">?</button>
            </div>
        </div>

        <div class="controls-area">
            <div id="message-box">코어(빨간색)를 탈출구(초록색)로 옮기세요!</div>

            <div class="d-pad">
                <div class="axis-group">
                    <span class="axis-label">X축</span>
                    <button class="control-btn" id="move-x-pos" disabled>►</button>
                    <button class="control-btn" id="move-x-neg" disabled>◄</button>
                </div>
                <div class="axis-group">
                    <span class="axis-label">Y축</span>
                    <button class="control-btn" id="move-y-pos" disabled>▲</button>
                    <button class="control-btn" id="move-y-neg" disabled>▼</button>
                </div>
                <div class="axis-group">
                    <span class="axis-label">Z축</span>
                    <button class="control-btn" id="move-z-pos" disabled>Out</button>
                    <button class="control-btn" id="move-z-neg" disabled>In</button>
                </div>
            </div>

            <div class="control-hint">블록 선택 후 스와이프 이동(모바일) · 화살표/키보드 이동 (←→↑↓, Q/E) · 이동 가능 칸 표시 · U: UNDO · R: RESET · X: X-RAY</div>
            <div class="legend">
                <span class="legend-item legend-core">CORE</span>
                <span class="legend-item legend-data">DATA</span>
                <span class="legend-item legend-firewall">FIREWALL</span>
                <span class="legend-item legend-exit">EXIT</span>
            </div>
        </div>
    </div>

    <script type="module" src="core-hacker.js"></script>
</body>
</html>
